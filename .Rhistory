install.packages("Boruta")
library("Boruta", lib.loc="~/R/win-library/3.3")
library("Rcpp", lib.loc="~/R/win-library/3.3")
library("RcppEigen", lib.loc="~/R/win-library/3.3")
library(randomForest)
library(grid)
library(MVT)
library(mvtnorm)
install.packages("MVT")
library(party)
library("MVT", lib.loc="~/R/win-library/3.3")
library("Boruta", lib.loc="~/R/win-library/3.3")
install.packages("party")
library("party", lib.loc="~/R/win-library/3.3")
install.packages("rpart")
library(party)
library(rpart)
library(RColorBrewer)
install.packages("RColorBrewer")
library("RColorBrewer", lib.loc="~/R/win-library/3.3")
library(RColorBrewer)
library(basetheme)
install.packages("basetheme")
library(basetheme)
library(gtools)
install.packages("gtools")
library(gtools)
library(rpart.plot)
library(ranger)
library(lattice)
14.	library(caret)
install.packages("caret")
library("caret", lib.loc="~/R/win-library/3.3")
library(gtools)
library(rpart.plot)
library(randomForest)
library(grid)
library(MVT)
library(mvtnorm)
library(party)
library(rpart)
library(RColorBrewer)
library(basetheme)
library(gtools)
library(rpart.plot)
library(ranger)
library(lattice)
library(caret)
library(RColorBrewer)
library(ape)
library(treebase)
library(ggplot2movies)
setwd("F://INTRUSION")
dataset<-read.csv("Train_data.csv",header = T)
View(dataset)
dim(dataset)
str(dataset)
shuffle_index <- sample(1:nrow(dataset))
dataset <- dataset[shuffle_index,]
head(dataset)
install.packages("rpart.plot")
install.packages("rpart")
install.packages("multcomp")
install.packages("multcomp")
install.packages("rpart")
install.packages("rpart")
install.packages("rsq")
ind<-sample(2,nrow(dataset),replace = T,prob = c(.9,.1))
train_data<-dataset[ind==1,]
test_data<-dataset[ind==2,]
dim(train_data)
prop.table(table(train_data$xAttack))
set.seed(1001)
random_dataset<-randomForest(xAttack~.,data=dataset,mtry=3,ntree=250)
print(random_dataset)
pred_dataset<-predict(random_dataset,test_data)
set.seed(1001)
install.packages("rpart")
fit <-rpart(xAttack~.,data=train_data,method = "class")
plot(xAttack~duration,data=train_data)
plot(train_data$duration,train_data$xAttack)
box(train_data$duration)
par(las=1)
plot(c(1,2),train_data$xAttack,type="1",xlab = "duration",ylab = "xAttack",lty=2,lwd=3,col="red")
library(rpart)
Train_data.csv <- xAttack[c(1:105),]
plot(xAttack, main = NULL, type = c("extended", "simple"),terminal_panel = NULL, tp_args = list(),inner_panel = node_inner, ip_args = list(),edge_panel = edge_simple, ep_args = list(),drop_terminal = (type[1] == "extended"),tnex = (type[1] == "extended") + 1, newpage = TRUE,pop = TRUE)
printcp(fit)
plotcp(fit)
summary(fit)
plot(fit, uniform=TRUE,main="Regression Tree ")
text(fit, use.n=TRUE, all=TRUE, cex=.8)
post(fit, file = "F:/Train_data.csv",title = "Classification Tree")
88.	post(fit, file = "train_data",title = "Classification Tree")
pfit<- prune(fit, cp= fit$cptable[which.min(fit$cptable[,"xAttack"]),"CP"])
fit <- rpart(xAttack~duration + protocol_type + count + hot,method="anova", data=train_data)
printcp(fit)
plotcp(fit)
summary(fit)
plotcp(fit)
summary(fit)
par(mfrow=c(1,2))
rsq.rpart(fit)
plot(fit, uniform=TRUE,main="Regression Tree ")
text(fit, use.n=TRUE, all=TRUE, cex=.8)
post(fit, file = "F:/Train_data.csv",title = "Regression Tree ")
post(fit, file = "train_data",title = "Regression Tree ")
pfit<- prune(fit, cp=0.01160389)
plot(pfit, uniform=TRUE,main="Pruned Regression Tree")
text(pfit, use.n=TRUE, all=TRUE, cex=.8)
post(pfit, file = "F:/Train_data.csv",title = "Pruned Regression Tree")
post(pfit, file = "train_data",title = "Pruned Regression Tree")
fit <- randomForest(xAttack ~ protocol_type + count + duration,   data=train_data)
print(fit)
library(randomForest)
library(grid)
library(MVT)
library(mvtnorm)
install.packages("party")
library(party)
install.packages("MVT")
install.packages("rpart")
install.packages("rpart")
install.packages("rpart")
install.packages("rpart")
library(rpart)
library(RColorBrewer)
install.packages("RColorBrewer")
library("Boruta", lib.loc="~/R/win-library/3.3")
install.packages("ranger")
library("Boruta", lib.loc="~/R/win-library/3.3")
library("caret", lib.loc="~/R/win-library/3.3")
install.packages("caret")
library(randomForest)
library(randomForest)
library(grid)
library(MVT)
library(mvtnorm)
library(party)
library(rpart)
library(RColorBrewer)
library(basetheme)
library(gtools)
library(rpart.plot)
library(ranger)
library(lattice)
library(caret)
library(RColorBrewer)
library(ape)
library(treebase)
library(ggplot2movies)
setwd("F://INTRUSION")
dataset<-read.csv("Train_data.csv",header = T)
View(dataset)
dim(dataset)
str(dataset)
shuffle_index <- sample(1:nrow(dataset))
dataset <- dataset[shuffle_index,]
head(dataset)
install.packages("rpart.plot")
install.packages("rpart")
install.packages("rpart")
install.packages("rpart")
install.packages("rpart")
install.packages("rpart")
install.packages("rpart")
install.packages("multcomp")
install.packages("rsq")
ind<-sample(2,nrow(dataset),replace = T,prob = c(.9,.1))
train_data<-dataset[ind==1,]
test_data<-dataset[ind==2,]
dim(train_data)
prop.table(table(train_data$xAttack))
install.packages("rpart")
install.packages("rpart")
install.packages("rpart")
set.seed(1001)
random_dataset<-randomForest(xAttack~.,data=dataset,mtry=3,ntree=250)
print(random_dataset)
pred_dataset<-predict(random_dataset,test_data)
set.seed(1001)
install.packages("rpart")
install.packages("rpart")
install.packages("rpart")
fit <-rpart(xAttack~.,data=train_data,method = "class")
plot(xAttack~duration,data=train_data)
plot(train_data$duration,train_data$xAttack)
box(train_data$duration)
par(las=1)
plot(c(1,2),train_data$xAttack,type="1",xlab = "duration",ylab = "xAttack",lty=2,lwd=3,col="red")
library(rpart)
Train_data.csv <- xAttack[c(1:105),]
plot(xAttack, main = NULL, type = c("extended", "simple"),terminal_panel = NULL, tp_args = list(),inner_panel = node_inner, ip_args = list(),edge_panel = edge_simple, ep_args = list(),drop_terminal = (type[1] == "extended"),tnex = (type[1] == "extended") + 1, newpage = TRUE,pop = TRUE)
printcp(fit)
plotcp(fit)
summary(fit)
plot(fit, uniform=TRUE,main="Regression Tree ")
text(fit, use.n=TRUE, all=TRUE, cex=.8)
post(fit, file = "F:/Train_data.csv",title = "Classification Tree")
post(fit, file = "train_data",title = "Classification Tree")
pfit<- prune(fit, cp= fit$cptable[which.min(fit$cptable[,"xAttack"]),"CP"])
fit <- rpart(xAttack~duration + protocol_type + count + hot,method="anova", data=train_data)
printcp(fit)
plotcp(fit)
summary(fit)
plotcp(fit)
summary(fit)
par(mfrow=c(1,2))
rsq.rpart(fit)
plot(fit, uniform=TRUE,main="Regression Tree ")
text(fit, use.n=TRUE, all=TRUE, cex=.8)
post(fit, file = "F:/Train_data.csv",title = "Regression Tree ")
post(fit, file = "train_data",title = "Regression Tree ")
pfit<- prune(fit, cp=0.01160389)
plot(pfit, uniform=TRUE,main="Pruned Regression Tree")
text(pfit, use.n=TRUE, all=TRUE, cex=.8)
post(pfit, file = "F:/Train_data.csv",title = "Pruned Regression Tree")
post(pfit, file = "train_data",title = "Pruned Regression Tree")
library(randomForest)
fit <- randomForest(xAttack ~ protocol_type + count + duration,   data=train_data)
print(fit)
